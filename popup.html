<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Camera Overlay</h1>

    <!-- Visual Preview (no camera needed) -->
    <div class="preview-section">
      <div id="preview-container">
        <div id="preview-placeholder">
          <div class="silhouette"></div>
          <span>Your camera view</span>
        </div>
        <div id="overlay-container"></div>
      </div>
      <p class="hint">Drag overlays to position them. They'll appear on your Meet camera.</p>
    </div>

    <!-- My Overlays Section -->
    <div class="overlay-section">
      <div class="section-header">
        <h2>My Overlays</h2>
        <div class="add-buttons">
          <button id="add-overlay" class="btn btn-primary">+ Image</button>
          <button id="add-effect" class="btn btn-effect">+ Effect</button>
          <button id="add-text-banner" class="btn btn-text">+ Text</button>
          <button id="add-timer" class="btn btn-timer">+ Timer</button>
        </div>
      </div>
      <div id="user-overlay-list" class="overlay-list"></div>
      <p id="user-empty-state" class="empty-state">No custom overlays yet. Add an image, effect, text banner, or timer to get started.</p>
    </div>

    <!-- Bundled Effects Section (hidden if empty) -->
    <div id="bundled-section" class="overlay-section bundled-section hidden">
      <div class="section-header">
        <h2>Bundled Effects</h2>
      </div>
      <div id="bundled-overlay-list" class="overlay-list"></div>
    </div>

    <!-- Wall Art Section -->
    <div class="overlay-section wall-art-section">
      <div class="section-header">
        <h2>Wall Art</h2>
        <button id="add-wall-art" class="btn btn-wall-art">+ Wall Art</button>
      </div>
      <div id="wall-art-list" class="overlay-list"></div>
      <p id="wall-art-empty-state" class="empty-state">No wall art regions. Add one to paint your background or display art behind you.</p>

      <!-- Setup Wizard Trigger -->
      <div id="wizard-trigger-section" class="wizard-trigger-section">
        <div class="wizard-status" id="wizard-status">
          <span class="wizard-status-icon">⚙️</span>
          <span class="wizard-status-text">Setup not complete</span>
        </div>
        <button id="run-wizard" class="btn btn-wizard">Run Setup Wizard</button>
      </div>

      <!-- Segmentation Settings -->
      <div id="segmentation-panel" class="segmentation-panel">
        <div class="segmentation-toggle">
          <label class="toggle-switch">
            <input type="checkbox" id="segmentation-enabled">
            <span class="toggle-slider"></span>
          </label>
          <span class="toggle-label">Person Occlusion</span>
          <span class="toggle-hint">(you appear in front of wall art)</span>
        </div>
        <div id="segmentation-options" class="segmentation-options hidden">
          <div class="form-group">
            <label>Performance Preset</label>
            <select id="segmentation-preset">
              <option value="quality">Quality (slower)</option>
              <option value="balanced" selected>Balanced</option>
              <option value="performance">Performance (faster)</option>
            </select>
          </div>
          <div class="form-group">
            <label>Edge Feather: <span id="feather-value">2px</span></label>
            <input type="range" id="feather-radius" min="0" max="5" value="2" step="1">
          </div>
        </div>
      </div>
    </div>

    <!-- Add Overlay Modal -->
    <div id="add-modal" class="modal hidden">
      <div class="modal-content">
        <h3 id="modal-title">Add Image Overlay</h3>
        <p id="modal-hint" class="modal-hint"></p>
        <div class="form-group">
          <label>Image URL</label>
          <input type="text" id="image-url" placeholder="https://example.com/image.png">
        </div>
        <div class="form-group">
          <label>Or upload a file</label>
          <input type="file" id="image-file" accept="image/*,.gif">
        </div>
        <div class="modal-actions">
          <button id="cancel-add" class="btn btn-secondary">Cancel</button>
          <button id="confirm-add" class="btn btn-primary">Add</button>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal hidden">
      <div class="modal-content confirm-dialog">
        <h3 id="confirm-title">Confirm Action</h3>
        <p id="confirm-message"></p>
        <div class="modal-actions">
          <button id="confirm-cancel" class="btn btn-secondary">Cancel</button>
          <button id="confirm-ok" class="btn btn-danger">Delete</button>
        </div>
      </div>
    </div>

    <!-- Text Banner Modal -->
    <div id="text-banner-modal" class="modal hidden">
      <div class="modal-content modal-wide">
        <h3 id="text-banner-modal-title">Add Text Banner</h3>
        <div class="form-group">
          <label>Text (use Enter for multiple lines)</label>
          <textarea id="text-banner-input" rows="3" placeholder="Your text here..."></textarea>
        </div>
        <div class="form-row">
          <div class="form-group form-group-half">
            <label>Position</label>
            <select id="text-banner-position">
              <option value="lower-third">Lower Third</option>
              <option value="top">Top</option>
              <option value="center">Center</option>
              <option value="custom">Custom</option>
            </select>
          </div>
          <div class="form-group form-group-half">
            <label>Font Size</label>
            <input type="number" id="text-banner-font-size" value="24" min="12" max="72">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group form-group-half">
            <label>Text Color</label>
            <input type="color" id="text-banner-text-color" value="#ffffff">
          </div>
          <div class="form-group form-group-half">
            <label>Background Color</label>
            <input type="color" id="text-banner-bg-color" value="#000000">
          </div>
        </div>
        <div class="form-group">
          <label>Background Opacity: <span id="text-banner-opacity-value">70%</span></label>
          <input type="range" id="text-banner-bg-opacity" min="0" max="100" value="70">
        </div>
        <div class="modal-actions">
          <button id="text-banner-cancel" class="btn btn-secondary">Cancel</button>
          <button id="text-banner-confirm" class="btn btn-primary">Add</button>
        </div>
      </div>
    </div>

    <!-- Timer Modal -->
    <div id="timer-modal" class="modal hidden">
      <div class="modal-content modal-wide">
        <h3 id="timer-modal-title">Add Timer</h3>
        <div class="form-group">
          <label>Timer Mode</label>
          <select id="timer-mode">
            <option value="countdown">Countdown</option>
            <option value="countup">Count Up</option>
            <option value="clock">Clock (Current Time)</option>
          </select>
        </div>
        <div id="timer-duration-group" class="form-group">
          <label>Duration</label>
          <div class="duration-inputs">
            <input type="number" id="timer-minutes" value="5" min="0" max="999" placeholder="min">
            <span>:</span>
            <input type="number" id="timer-seconds" value="0" min="0" max="59" placeholder="sec">
          </div>
          <div class="duration-presets">
            <button type="button" class="btn btn-small" data-duration="60">1 min</button>
            <button type="button" class="btn btn-small" data-duration="300">5 min</button>
            <button type="button" class="btn btn-small" data-duration="600">10 min</button>
            <button type="button" class="btn btn-small" data-duration="900">15 min</button>
          </div>
        </div>
        <div class="form-group">
          <label>Position</label>
          <div class="position-grid">
            <button type="button" class="position-btn" data-position="top-left">↖</button>
            <button type="button" class="position-btn" data-position="top-center">↑</button>
            <button type="button" class="position-btn active" data-position="top-right">↗</button>
            <button type="button" class="position-btn" data-position="bottom-left">↙</button>
            <button type="button" class="position-btn" data-position="bottom-center">↓</button>
            <button type="button" class="position-btn" data-position="bottom-right">↘</button>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group form-group-half">
            <label>Text Color</label>
            <input type="color" id="timer-text-color" value="#ffffff">
          </div>
          <div class="form-group form-group-half">
            <label>Background Color</label>
            <input type="color" id="timer-bg-color" value="#000000">
          </div>
        </div>
        <div class="modal-actions">
          <button id="timer-cancel" class="btn btn-secondary">Cancel</button>
          <button id="timer-confirm" class="btn btn-primary">Add</button>
        </div>
      </div>
    </div>

    <!-- Wall Art Modal -->
    <div id="wall-art-modal" class="modal hidden">
      <div class="modal-content modal-wide wall-art-modal">
        <h3 id="wall-art-modal-title">Add Wall Art Region</h3>

        <!-- Region Canvas -->
        <div class="wall-art-region-editor">
          <canvas id="wall-art-region-canvas" width="320" height="180"></canvas>
          <p class="hint">Drag corners to adjust region shape</p>
        </div>

        <!-- Tabs for Paint and Art -->
        <div class="wall-art-tabs">
          <button type="button" class="wall-art-tab active" data-tab="paint">Paint</button>
          <button type="button" class="wall-art-tab" data-tab="art">Art</button>
        </div>

        <!-- Paint Tab Content -->
        <div id="wall-art-paint-tab" class="wall-art-tab-content">
          <div class="form-group">
            <label class="toggle-inline">
              <input type="checkbox" id="wall-art-paint-enabled">
              <span>Enable Paint Fill</span>
            </label>
          </div>
          <div class="form-row">
            <div class="form-group form-group-half">
              <label>Color</label>
              <input type="color" id="wall-art-paint-color" value="#808080">
            </div>
            <div class="form-group form-group-half">
              <label>Opacity: <span id="wall-art-paint-opacity-value">100%</span></label>
              <input type="range" id="wall-art-paint-opacity" min="0" max="100" value="100">
            </div>
          </div>
        </div>

        <!-- Art Tab Content -->
        <div id="wall-art-art-tab" class="wall-art-tab-content hidden">
          <div class="form-group">
            <label>Image URL</label>
            <input type="text" id="wall-art-image-url" placeholder="https://example.com/image.png">
          </div>
          <div class="form-group">
            <label>Or upload a file (image, GIF, or video)</label>
            <input type="file" id="wall-art-image-file" accept="image/*,.gif,video/mp4,video/webm">
          </div>
          <div class="form-row">
            <div class="form-group form-group-half">
              <label>Aspect Ratio</label>
              <select id="wall-art-aspect-mode">
                <option value="stretch">Stretch</option>
                <option value="fit">Fit</option>
                <option value="crop">Crop</option>
              </select>
            </div>
            <div class="form-group form-group-half">
              <label>Opacity: <span id="wall-art-art-opacity-value">100%</span></label>
              <input type="range" id="wall-art-art-opacity" min="0" max="100" value="100">
            </div>
          </div>
        </div>

        <div class="modal-actions">
          <button id="wall-art-cancel" class="btn btn-secondary">Cancel</button>
          <button id="wall-art-confirm" class="btn btn-primary">Add</button>
        </div>
      </div>
    </div>

    <!-- Setup Wizard Modal -->
    <div id="wizard-modal" class="modal hidden">
      <div class="modal-content modal-wizard">
        <div class="wizard-header">
          <h3>Setup Wizard</h3>
          <button id="wizard-close" class="wizard-close-btn">×</button>
        </div>

        <!-- Progress Steps -->
        <div class="wizard-progress">
          <div class="wizard-step" data-step="1">
            <div class="wizard-step-circle">1</div>
            <div class="wizard-step-label">Step Away</div>
          </div>
          <div class="wizard-step-line"></div>
          <div class="wizard-step" data-step="2">
            <div class="wizard-step-circle">2</div>
            <div class="wizard-step-label">Processing</div>
          </div>
          <div class="wizard-step-line"></div>
          <div class="wizard-step" data-step="3">
            <div class="wizard-step-circle">3</div>
            <div class="wizard-step-label">Draw Region</div>
          </div>
          <div class="wizard-step-line"></div>
          <div class="wizard-step" data-step="4">
            <div class="wizard-step-circle">4</div>
            <div class="wizard-step-label">Confirm</div>
          </div>
        </div>

        <!-- Step 1: Step Away Countdown -->
        <div id="wizard-step-1" class="wizard-content">
          <div class="wizard-countdown-container">
            <div class="wizard-countdown-number" id="wizard-countdown">5</div>
            <div class="wizard-countdown-text">Step out of frame...</div>
            <p class="wizard-hint">Move away from your camera so we can capture your background.</p>
          </div>
        </div>

        <!-- Step 2: Processing -->
        <div id="wizard-step-2" class="wizard-content hidden">
          <div class="wizard-tasks">
            <div class="wizard-task" data-task="capture">
              <span class="wizard-task-icon">⏳</span>
              <span class="wizard-task-text">Capturing reference frame...</span>
            </div>
            <div class="wizard-task" data-task="benchmark">
              <span class="wizard-task-icon">⏳</span>
              <span class="wizard-task-text">Running performance benchmark...</span>
            </div>
            <div class="wizard-task" data-task="analyze">
              <span class="wizard-task-icon">⏳</span>
              <span class="wizard-task-text">Analyzing results...</span>
            </div>
          </div>
        </div>

        <!-- Step 3: Draw Region -->
        <div id="wizard-step-3" class="wizard-content hidden">
          <div class="wizard-region-editor">
            <canvas id="wizard-region-canvas" width="320" height="180"></canvas>
            <p class="wizard-hint">Drag corners to define your wall art region. The background shows your captured frame.</p>
          </div>
        </div>

        <!-- Step 4: Confirm Settings -->
        <div id="wizard-step-4" class="wizard-content hidden">
          <div class="wizard-summary">
            <div class="wizard-summary-item">
              <span class="wizard-summary-label">Recommended Preset:</span>
              <select id="wizard-preset-select">
                <option value="quality">Quality (slower)</option>
                <option value="balanced">Balanced</option>
                <option value="performance">Performance (faster)</option>
              </select>
            </div>
            <div class="wizard-benchmark-results" id="wizard-benchmark-results">
              <p class="wizard-hint">Benchmark results will appear here...</p>
            </div>
            <div class="wizard-summary-item">
              <span class="wizard-summary-label">Region Defined:</span>
              <span class="wizard-summary-value" id="wizard-region-status">✓ Ready</span>
            </div>
          </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="wizard-actions">
          <button id="wizard-cancel" class="btn btn-secondary">Cancel</button>
          <button id="wizard-next" class="btn btn-primary">Next</button>
        </div>
      </div>
    </div>

    <!-- Effect Preview (shown on hover) -->
    <div id="effect-preview" class="effect-preview hidden">
      <img class="effect-preview-img" src="" alt="">
      <div class="effect-preview-name"></div>
      <div class="effect-preview-badge">Animated</div>
    </div>

    <!-- Status -->
    <div id="status" class="status"></div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
